<nav class="site-nav">
  <button class="menu-toggle" aria-label="Toggle navigation menu" type="button"></button>
  <ul id="main-menu">
    <!-- <li class="nav-jr home-anc"><h4><a href="#home"><br></a></h4></li> -->
    {% assign current = page.url | downcase | split: '/' %}
    <div class="flexbox-parent">
      <li class="about-anc">
        <a class="nav-underline home {% if page.url == '/' %}current{% endif %}" href="{{site.url}}">Home</a>
      </li>
      <li class="dropdown">
        <a class="nav-underline blog {% if page.url == '/blog/' %}current{% endif %}" href="{{site.url}}/blog">Blog</a>
        <div class="dropdown-content">
          <a href="{{site.url}}/blog/technical">Technical</a>
          <a href="{{site.url}}/blog/behavioural">Behavioural</a>
        </div>
      </li>
      <li class="about-anc">
        <a class="nav-underline about {% if page.url == '/about/' %}current{% endif %}" href="{{site.url}}/about">About</a>
      </li>
      <li class="search-anc">
        <a class="nav-underline search {% if page.url == '/search/' %}current{% endif %}" href="{{site.url}}/search">Search</a>
      </li>
      <!-- <li class="beliefs-anc" style="display: inline">
        <a class="nav-underline open-source {% if page.url == '/projects/' %}current{% endif %}" href="{{site.url}}/projects">Projects & Open Source</a>
      </li> -->
      <li class="team-anc">
        <a class="nav-underline library {% if page.url == '/library/' %}current{% endif %}" href="{{site.url}}/library">Library</a>
      </li>
      <li>
        {% if site.show_social_icons %}
        {% include social_links.html %}
        {% endif %}
      </li>
    </div>
  </ul>
</nav>

<script>
(function() {
  function initMobileMenu() {
    const menuToggle = document.querySelector('.menu-toggle');
    const mainMenu = document.getElementById('main-menu');
    
    if (!menuToggle || !mainMenu) return;

    // Debug log
    console.log('Mobile menu initialized');
    
    function toggleMenu(e) {
      if (e) {
        e.preventDefault();
        e.stopPropagation();
      }
      
      const isActive = menuToggle.classList.contains('active');
      menuToggle.classList.toggle('active');
      mainMenu.classList.toggle('active');
      
      // Debug log
      console.log('Menu toggled:', isActive ? 'closed' : 'opened');
    }

    function closeMenu() {
      menuToggle.classList.remove('active');
      mainMenu.classList.remove('active');
      // Debug log
      console.log('Menu closed');
    }

    // Toggle menu on button click
    menuToggle.addEventListener('click', toggleMenu);

    // Close menu when clicking a link
    mainMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', closeMenu);
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!mainMenu.contains(e.target) && 
          !menuToggle.contains(e.target) && 
          mainMenu.classList.contains('active')) {
        closeMenu();
      }
    });

    // Close menu on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && mainMenu.classList.contains('active')) {
        closeMenu();
      }
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initMobileMenu);
  } else {
    initMobileMenu();
  }
})();
</script>
