---
layout: default
title: Search
permalink: /search/
---

<div class="search-container">
  <h1>Search Blog Posts</h1>
  
  <div class="search-box">
    <input type="text" id="search-input" placeholder="Search blog posts...">
    <button id="search-button">Search</button>
  </div>

  <div id="search-results"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('search-input');
  const searchButton = document.getElementById('search-button');
  const resultsContainer = document.getElementById('search-results');
  let posts = [];

  // Get the base URL for the site
  const baseUrl = window.location.origin;
  console.log('Base URL:', baseUrl);

  // Fetch posts data using absolute URL
  fetch(baseUrl + '/search.json')
    .then(response => {
      console.log('Response status:', response.status);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.text().then(text => {
        console.log('Raw response:', text);
        try {
          return JSON.parse(text);
        } catch (e) {
          console.error('JSON Parse Error:', e);
          throw new Error('Invalid JSON response');
        }
      });
    })
    .then(data => {
      console.log('Parsed data:', data);
      if (!data || !data.posts) {
        throw new Error('Invalid data structure');
      }
      posts = data.posts;
      if (posts.length === 0) {
        resultsContainer.innerHTML = '<p>No blog posts found.</p>';
        return;
      }
      // If there's a search term in the URL, perform the search
      const urlParams = new URLSearchParams(window.location.search);
      const searchTerm = urlParams.get('q');
      if (searchTerm) {
        searchInput.value = searchTerm;
        performSearch(searchTerm);
      }
    })
    .catch(error => {
      console.error('Error:', error);
      resultsContainer.innerHTML = `
        <div class="error">
          <p>Error loading search data: ${error.message}</p>
          <p>Please try again later or contact the site administrator.</p>
        </div>
      `;
    });

  function performSearch(searchTerm) {
    if (!searchTerm || searchTerm.length < 2) {
      resultsContainer.innerHTML = '';
      return;
    }

    searchTerm = searchTerm.toLowerCase();
    const filteredPosts = posts.filter(post => {
      const searchableText = [
        post.title || '',
        post.excerpt || '',
        post.content || ''
      ].join(' ').toLowerCase();
      return searchableText.includes(searchTerm);
    });

    displayResults(filteredPosts);
  }

  function displayResults(results) {
    if (results.length === 0) {
      resultsContainer.innerHTML = '<p>No results found.</p>';
      return;
    }

    const html = results.map(post => `
      <article class="search-result">
        <h2><a href="${post.url}" target="_blank">${post.title || 'Untitled'}</a></h2>
        <div class="post-meta">
          <span class="date">${post.date || 'No date'}</span>
        </div>
        <div class="post-excerpt">${post.excerpt || 'No excerpt available'}</div>
      </article>
    `).join('');

    resultsContainer.innerHTML = html;
  }

  // Event listeners
  searchInput.addEventListener('input', function() {
    performSearch(this.value);
  });

  searchButton.addEventListener('click', function() {
    performSearch(searchInput.value);
  });

  searchInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      performSearch(this.value);
    }
  });
});
</script>

<style>
.search-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
}

.search-box {
  display: flex;
  gap: 10px;
  margin: 2rem 0;
}

#search-input {
  flex: 1;
  padding: 12px 20px;
  font-size: 16px;
  border: 2px solid #ddd;
  border-radius: 4px;
  transition: border-color 0.3s ease;
}

#search-button {
  padding: 12px 24px;
  font-size: 16px;
  background-color: #333;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

#search-button:hover {
  background-color: #444;
}

#search-input:focus {
  border-color: #333;
  outline: none;
}

.search-result {
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid #eee;
}

.search-result h2 {
  margin: 0 0 0.5rem 0;
}

.search-result h2 a {
  color: #333;
  text-decoration: none;
}

.search-result h2 a:hover {
  text-decoration: underline;
}

.post-meta {
  font-size: 0.9rem;
  color: #666;
  margin-bottom: 0.5rem;
}

.post-excerpt {
  color: #444;
  line-height: 1.6;
}

.error {
  color: #721c24;
  background-color: #f8d7da;
  border: 1px solid #f5c6cb;
  padding: 1rem;
  border-radius: 4px;
  margin: 1rem 0;
}
</style> 
